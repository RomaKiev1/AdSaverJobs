SetCallInfoJob работает по такому алгоритму

ќн добавл€ет в таблицу Visits значение пол€ cdrId

Ёти значени€ берутс€ из таблици cdr.

—в€зываютс€ таблицы Visits и cdr по пол€м соответсвенно UserNumber ( в таблице Visits ) и dst ( в таблице cdr )

«аписи отфильтровываютс€ по таким пол€м:

¬ таблице Visits:

1. cdrId не равен null

¬ таблице cdr:

1. calldate больше текущей даты
2. dcontext равен ext-group
3. calldate находитс€ в интервале дат между datetime и lastupdate (в таблице Visits) + 3 минуты
   ( то есть по номеру телефона, на который был сделан звонок, и по вхождению даты звонка в интервал дат
     посещени€ сайта, мы определ€ем принадлежность данного звонка данному посетителю )